//go:build release

package goruntime

import (
	"archive/zip"
	"bytes"
	_ "embed"
)

//go:embed scaffolding.zip
var archive []byte

//go:embed external-module-template.zip
var externalModuleTemplate []byte

// Files is the FTL Kotlin runtime scaffolding files.
//
// scaffolding.zip can be generated by running `bit kotlin-runtime/scaffolding.zip`
// or indirectly via `bit build/release/ftl`.
func Files() *zip.Reader {
	zr, err := zip.NewReader(bytes.NewReader(archive), int64(len(archive)))
	if err != nil {
		panic(err)
	}
	return zr
}

// ExternalModuleTemplates are templates for scaffolding external modules in the FTL Kotlin runtime.
//
// external-module-template.zip can be generated by running `bit kotlin-runtime/external-module-template.zip`
// or indirectly via `bit build/release/ftl`.
func ExternalModuleTemplates() *zip.Reader {
	zr, err := zip.NewReader(bytes.NewReader(externalModuleTemplate), int64(len(externalModuleTemplate)))
	if err != nil {
		panic(err)
	}
	return zr
}
